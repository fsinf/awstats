Description: Prevent nested includes from being prematurely closed.
Author: Ken Neighbors <debian3@ken.nsds.com>
Bug-Debian: http://bugs.debian.org/575545

--- a/tools/awstats_buildstaticpages.pl
+++ b/tools/awstats_buildstaticpages.pl
@@ -197,6 +197,7 @@
 				warning("Warning: Perl versions before 5.6 cannot handle nested includes");
 				next;
 			}
+		    local( *CONFIG_INCLUDE );
 		    if ( open( CONFIG_INCLUDE, $includeFile ) ) {
 				&Parse_Config( *CONFIG_INCLUDE , $level+1, $includeFile);
 				close( CONFIG_INCLUDE );
--- a/wwwroot/cgi-bin/awstats.pl
+++ b/wwwroot/cgi-bin/awstats.pl
@@ -1852,6 +1852,7 @@
 				);
 				next;
 			}
+			local( *CONFIG_INCLUDE );
 			if ( open( CONFIG_INCLUDE, $includeFile ) ) {
 				&Parse_Config( *CONFIG_INCLUDE, $level + 1, $includeFile );
 				close(CONFIG_INCLUDE);
